/*! Sticker - v0.4.0 - 2013-02-09
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t,e,s,i){"use strict";var n=s(t),o=n.height(),r={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){s.each(r.instances,function(t,e){e.enabled&&(r.types[e.type].scroll(e),s.isFunction(e.options.scroll)&&e.options.scroll.call(e))})},resize:function(){o=n.height(),s.each(r.instances,function(t,e){e.enabled&&(r.types[e.type].resize(e),r.types[e.type].scroll(e),s.isFunction(e.options.resize)&&e.options.resize.call(e))})},start:function(){this.started||(n.on("scroll",this.scroll),n.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,n.off("scroll",this.scroll),n.off("resize",this.resize)}},p=s.Sticker=function(t,e){this.element=t,this.$element=s(t),this.type=e.type!==i?e.type:p.defaults.type,this.options=s.extend({},p.defaults,r.types[this.type].defaults,e),this.enabled=!1;var n=this.options.namespace;this.classes={},this.classes.wrapper=n+"-wrapper",this.classes.enabled=n+"-enabled",this.components={},this.init()};p.defaults={namespace:"sticker",type:"top",scroll:null,resize:null},p.registerType=function(t,e){r.types[t]=e},p.prototype={constructor:p,init:function(){this.id=r.generateId();var t=s("<div></div>").addClass(this.classes.wrapper),e=this.$element.attr("id");e!==i&&t.attr("id",e+"-"+this.classes.wrapper),this.$element.wrapAll(t),this.$wrapper=this.$element.parent(),r.types[this.type].init(this),this.enable(),r.types[this.type].scroll(this),r.instances.push(this),r.start()},destroy:function(){this.$element.unwrap();for(var t in r.instances)r.instances[t].id===this.id&&r.instances.splice(t,1);0===r.instances.length&&r.stop()},enable:function(){this.enabled=!0,r.types[this.type].scroll(this),this.$wrapper.addClass(this.classes.enabled)},disable:function(){this.enabled=!1,r.types[this.type].normalize(this),this.$wrapper.removeClass(this.classes.enabled)}},p.registerType("top",{defaults:{topSpace:0},init:function(t){t.$wrapper.css("height",t.$element.outerHeight())},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top;t.options.topSpace>s&&(t.options.topSpace=s);var i=s-t.options.topSpace-e;0>i?t.$element.css({position:"fixed",top:t.options.topSpace}):t.$element.css({position:"",top:""})},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},normalize:function(t){t.$element.css({position:"",top:""}),t.$wrapper.css("height","")}}),p.registerType("bottom",{defaults:{bottomSpace:0},init:function(t){t.$wrapper.css("height",t.$element.outerHeight())},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top,i=t.$element.outerHeight(),r=e-(s-o+i+t.options.bottomSpace);0>r?t.$element.css({position:"fixed",bottom:t.options.bottomSpace}):t.$element.css({position:"",bottom:""})},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},normalize:function(t){t.$element.css({position:"",bottom:""}),t.$wrapper.css("height","")}}),p.registerType("sidebar",{defaults:{topSpace:0,container:null},init:function(t){t.$container=t.options.container?s(t.options.container):t.$wrapper.parent(),t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top,i=t.$element.outerHeight(),o=e-s+t.options.topSpace;if(o>0){var r=t.containerHeight-i+t.containerTop-s;o>r?t.$wrapper.css({paddingTop:r}):t.$wrapper.css({paddingTop:o})}else t.$wrapper.css({paddingTop:""})},resize:function(t){t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},normalize:function(t){t.$wrapper.css({paddingTop:""})}}),s.fn.sticker=function(t){if("string"==typeof t){var e=t,n=arguments.length>1?Array.prototype.slice.call(arguments,1):i;return this.each(function(){var t=s.data(this,"sticker");"function"==typeof t[e]&&t[e].apply(t,n)})}return this.each(function(){s.data(this,"sticker")||s.data(this,"sticker",new p(this,t))})}})(window,document,jQuery);