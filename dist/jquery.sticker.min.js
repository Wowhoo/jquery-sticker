/*! Sticker - v0.6.2 - 2013-03-13
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t,s,e,i){"use strict";var n=e(t),o=n.height(),c={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){e.each(c.instances,function(t,s){s.enabled&&(c.types[s.type].scroll(s),e.isFunction(s.options.scroll)&&s.options.scroll.call(s))})},resize:function(){o=n.height(),e.each(c.instances,function(t,s){s.enabled&&(c.types[s.type].resize(s),c.types[s.type].scroll(s),e.isFunction(s.options.resize)&&s.options.resize.call(s))})},start:function(){this.started||(n.on("scroll",this.scroll),n.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,n.off("scroll",this.scroll),n.off("resize",this.resize)}},p=e.Sticker=function(t,s){this.element=t,this.$element=e(t),this.type=s.type!==i?s.type:p.defaults.type,this.options=e.extend({},p.defaults,c.types[this.type].defaults,s),this.enabled=!1,this.sticky=!1;var n=this.options.namespace;this.classes={},this.classes.wrapper=n+"-wrapper",this.classes.enabled=n+"-enabled",this.classes.sticky=n+"-sticky",this.components={},this.init()};p.defaults={namespace:"sticker",type:"top",init:null,destroy:null,scroll:null,resize:null,enable:null,disable:null,sticky:null,unsticky:null},p.registerType=function(t,s){c.types[t]=s},p.prototype={constructor:p,init:function(){this.id=c.generateId();var t=e("<div></div>").addClass(this.classes.wrapper),s=this.$element.attr("id");s!==i&&t.attr("id",s+"-"+this.classes.wrapper),this.$element.wrapAll(t),this.$wrapper=this.$element.parent(),c.types[this.type].init(this),e.isFunction(this.options.init)&&this.options.init.call(this),this.enable(),c.instances.push(this),c.start()},destroy:function(){this.$element.unwrap();for(var t in c.instances)c.instances[t].id===this.id&&c.instances.splice(t,1);0===c.instances.length&&c.stop(),e.isFunction(this.options.destroy)&&this.options.destroy.call(this)},enable:function(){this.enabled=!0,c.types[this.type].enable(this),c.types[this.type].scroll(this),this.$wrapper.addClass(this.classes.enabled),e.isFunction(this.options.enable)&&this.options.enable.call(this)},disable:function(){this.enabled=!1,this.sticky=!1,c.types[this.type].disable(this),this.$wrapper.removeClass(this.classes.sticky).removeClass(this.classes.enabled),e.isFunction(this.options.disable)&&this.options.disable.call(this)},on:function(t,s){"string"==typeof t&&"function"==typeof s&&(this.options[t]=s)},off:function(t){"string"==typeof t&&(this.options[t]=null)},set:function(t,s){this.options[t]=s}},p.registerType("top",{defaults:{topSpace:0},init:function(){},scroll:function(t){var s=n.scrollTop(),i=t.$wrapper.offset().top;t.options.topSpace>i&&(t.options.topSpace=i);var o=i-t.options.topSpace-s;0>o?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",top:t.options.topSpace}),e.isFunction(t.options.sticky)&&t.options.sticky.call(t)):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",top:""}),e.isFunction(t.options.unsticky)&&t.options.unsticky.call(t))},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){t.$wrapper.css("height",t.$element.outerHeight())},disable:function(t){t.$element.css({position:"",top:""}),t.$wrapper.css("height","")}}),p.registerType("fill",{defaults:{check:!0,callback:null},init:function(){},scroll:function(t){var s=n.scrollTop(),i=e("body").height();0===s&&o>=i?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",bottom:0}),e.isFunction(t.options.sticky)&&t.options.sticky.call(t)):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",bottom:""}),e.isFunction(t.options.unsticky)&&t.options.unsticky.call(t)),e.isFunction(t.options.callback)&&t.options.callback.call(t,s,i,o)},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){if(t.$wrapper.css("height",t.$element.outerHeight()),t.options.check){var s=e("body").height();t.checkInterval=setInterval(function(){s!==e("body").height()&&(c.types[t.type].scroll(t),s=e("body").height())},500)}},disable:function(t){t.options.check&&clearInterval(t.checkInterval),t.$element.css({position:"",bottom:""}),t.$wrapper.css("height","")}}),p.registerType("bottom",{defaults:{bottomSpace:0},init:function(){},scroll:function(t){var s=n.scrollTop(),i=t.$wrapper.offset().top,c=t.$element.outerHeight(),p=s-(i-o+c+t.options.bottomSpace);0>p?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",bottom:t.options.bottomSpace}),e.isFunction(t.options.sticky)&&t.options.sticky.call(t)):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",bottom:""}),e.isFunction(t.options.unsticky)&&t.options.unsticky.call(t))},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){t.$wrapper.css("height",t.$element.outerHeight())},disable:function(t){t.$element.css({position:"",bottom:""}),t.$wrapper.css("height","")}}),p.registerType("sidebar",{defaults:{topSpace:0,container:null},init:function(t){t.$container=t.options.container?e(t.options.container):t.$wrapper.parent(),t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},scroll:function(t){var s=n.scrollTop(),i=t.$wrapper.offset().top,o=t.$element.outerHeight(),c=s-i+t.options.topSpace;if(c>0){t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky));var p=t.containerHeight-o+t.containerTop-i;c>p?t.$wrapper.css({paddingTop:p}):t.$wrapper.css({paddingTop:c}),e.isFunction(t.options.sticky)&&t.options.sticky.call(t)}else t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$wrapper.css({paddingTop:""}),e.isFunction(t.options.unsticky)&&t.options.unsticky.call(t))},resize:function(t){t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},enable:function(){},disable:function(t){t.$wrapper.css({paddingTop:""})}}),e.fn.sticker=function(t){if("string"==typeof t){var s=t,n=arguments.length>1?Array.prototype.slice.call(arguments,1):i;return this.each(function(){var t=e.data(this,"sticker");t&&"function"==typeof t[s]&&t[s].apply(t,n)})}return this.each(function(){e.data(this,"sticker")||e.data(this,"sticker",new p(this,t))})}})(window,document,jQuery);