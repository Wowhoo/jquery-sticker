/*! Sticker - v0.5.0 - 2013-02-09
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(a,b,c,d){"use strict";var e=c(a),f=e.height(),g={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){c.each(g.instances,function(a,b){b.enabled&&(g.types[b.type].scroll(b),c.isFunction(b.options.scroll)&&b.options.scroll.call(b))})},resize:function(){f=e.height(),c.each(g.instances,function(a,b){b.enabled&&(g.types[b.type].resize(b),g.types[b.type].scroll(b),c.isFunction(b.options.resize)&&b.options.resize.call(b))})},start:function(){this.started||(e.on("scroll",this.scroll),e.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,e.off("scroll",this.scroll),e.off("resize",this.resize)}},h=c.Sticker=function(a,b){this.element=a,this.$element=c(a),this.type=b.type!==d?b.type:h.defaults.type,this.options=c.extend({},h.defaults,g.types[this.type].defaults,b),this.enabled=!1;var e=this.options.namespace;this.classes={},this.classes.wrapper=e+"-wrapper",this.classes.enabled=e+"-enabled",this.classes.sticky=e+"-sticky",this.components={},this.init()};h.defaults={namespace:"sticker",type:"top",scroll:null,resize:null},h.registerType=function(a,b){g.types[a]=b},h.prototype={constructor:h,init:function(){this.id=g.generateId();var a=c("<div></div>").addClass(this.classes.wrapper),b=this.$element.attr("id");b!==d&&a.attr("id",b+"-"+this.classes.wrapper),this.$element.wrapAll(a),this.$wrapper=this.$element.parent(),g.types[this.type].init(this),this.enable(),g.types[this.type].scroll(this),g.instances.push(this),g.start()},destroy:function(){this.$element.unwrap();for(var a in g.instances)g.instances[a].id===this.id&&g.instances.splice(a,1);0===g.instances.length&&g.stop()},enable:function(){this.enabled=!0,g.types[this.type].scroll(this),this.$wrapper.addClass(this.classes.enabled)},disable:function(){this.enabled=!1,g.types[this.type].normalize(this),this.$wrapper.removeClass(this.classes.enabled)}},h.registerType("top",{defaults:{topSpace:0},init:function(a){a.$wrapper.css("height",a.$element.outerHeight())},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top;a.options.topSpace>c&&(a.options.topSpace=c);var d=c-a.options.topSpace-b;0>d?(a.$wrapper.addClass(a.classes.sticky),a.$element.css({position:"fixed",top:a.options.topSpace})):(a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",top:""}))},resize:function(a){a.$wrapper.css("height",a.$element.outerHeight())},normalize:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",top:""}),a.$wrapper.css("height","")}}),h.registerType("bottom",{defaults:{bottomSpace:0},init:function(a){a.$wrapper.css("height",a.$element.outerHeight())},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top,d=a.$element.outerHeight(),g=b-(c-f+d+a.options.bottomSpace);0>g?(a.$wrapper.addClass(a.classes.sticky),a.$element.css({position:"fixed",bottom:a.options.bottomSpace})):(a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""}))},resize:function(a){a.$wrapper.css("height",a.$element.outerHeight())},normalize:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""}),a.$wrapper.css("height","")}}),h.registerType("sidebar",{defaults:{topSpace:0,container:null},init:function(a){a.$container=a.options.container?c(a.options.container):a.$wrapper.parent(),a.containerHeight=a.$container.height(),a.containerTop=a.$container.offset().top},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top,d=a.$element.outerHeight(),f=b-c+a.options.topSpace;if(f>0){a.$wrapper.addClass(a.classes.sticky);var g=a.containerHeight-d+a.containerTop-c;f>g?a.$wrapper.css({paddingTop:g}):a.$wrapper.css({paddingTop:f})}else a.$wrapper.removeClass(a.classes.sticky),a.$wrapper.css({paddingTop:""})},resize:function(a){a.containerHeight=a.$container.height(),a.containerTop=a.$container.offset().top},normalize:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$wrapper.css({paddingTop:""})}}),c.fn.sticker=function(a){if("string"==typeof a){var b=a,e=arguments.length>1?Array.prototype.slice.call(arguments,1):d;return this.each(function(){var a=c.data(this,"sticker");"function"==typeof a[b]&&a[b].apply(a,e)})}return this.each(function(){c.data(this,"sticker")||c.data(this,"sticker",new h(this,a))})}})(window,document,jQuery);