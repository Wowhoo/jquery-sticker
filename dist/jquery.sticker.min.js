/*! Sticker - v0.6.0 - 2013-02-14
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(a,b,c,d){"use strict";var e=c(a),g=(c(b),e.height()),h={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){c.each(h.instances,function(a,b){b.enabled&&(h.types[b.type].scroll(b),c.isFunction(b.options.scroll)&&b.options.scroll.call(b))})},resize:function(){g=e.height(),c.each(h.instances,function(a,b){b.enabled&&(h.types[b.type].resize(b),h.types[b.type].scroll(b),c.isFunction(b.options.resize)&&b.options.resize.call(b))})},start:function(){this.started||(e.on("scroll",this.scroll),e.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,e.off("scroll",this.scroll),e.off("resize",this.resize)}},i=c.Sticker=function(a,b){this.element=a,this.$element=c(a),this.type=b.type!==d?b.type:i.defaults.type,this.options=c.extend({},i.defaults,h.types[this.type].defaults,b),this.enabled=!1;var e=this.options.namespace;this.classes={},this.classes.wrapper=e+"-wrapper",this.classes.enabled=e+"-enabled",this.classes.sticky=e+"-sticky",this.components={},this.init()};i.defaults={namespace:"sticker",type:"top",scroll:null,resize:null},i.registerType=function(a,b){h.types[a]=b},i.prototype={constructor:i,init:function(){this.id=h.generateId();var a=c("<div></div>").addClass(this.classes.wrapper),b=this.$element.attr("id");b!==d&&a.attr("id",b+"-"+this.classes.wrapper),this.$element.wrapAll(a),this.$wrapper=this.$element.parent(),this.sticky=!1,h.types[this.type].init(this),this.enable(),h.instances.push(this),h.start()},destroy:function(){this.$element.unwrap();for(var a in h.instances)h.instances[a].id===this.id&&h.instances.splice(a,1);0===h.instances.length&&h.stop()},enable:function(){this.enabled=!0,h.types[this.type].enable(this),h.types[this.type].scroll(this),this.$wrapper.addClass(this.classes.enabled)},disable:function(){this.enabled=!1,h.types[this.type].disable(this),this.$wrapper.removeClass(this.classes.enabled)}},i.registerType("top",{defaults:{topSpace:0},init:function(){},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top;a.options.topSpace>c&&(a.options.topSpace=c);var d=c-a.options.topSpace-b;0>d?a.sticky||(a.sticky=!0,a.$wrapper.addClass(a.classes.sticky),a.$element.css({position:"fixed",top:a.options.topSpace})):a.sticky&&(a.sticky=!1,a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",top:""}))},resize:function(a){a.$wrapper.css("height",a.$element.outerHeight())},enable:function(a){a.$wrapper.css("height",a.$element.outerHeight())},disable:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",top:""}),a.$wrapper.css("height","")}}),i.registerType("fill",{defaults:{check:!0,callback:null},init:function(){},scroll:function(a){var b=e.scrollTop(),d=c("body").height();0===b&&g>d?a.sticky||(a.sticky=!0,a.$wrapper.addClass(a.classes.sticky),a.$element.css({position:"fixed",bottom:0})):a.sticky&&(a.sticky=!1,a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""})),c.isFunction(a.options.callback)&&a.options.callback.call(a,b,d)},resize:function(a){a.$wrapper.css("height",a.$element.outerHeight())},enable:function(a){a.options.check&&(a.checkInterval=setInterval(function(){h.types[a.type].scroll(a)},500)),a.$wrapper.css("height",a.$element.outerHeight())},disable:function(a){a.options.check&&clearInterval(a.checkInterval),a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""}),a.$wrapper.css("height","")}}),i.registerType("bottom",{defaults:{bottomSpace:0},init:function(){},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top,d=a.$element.outerHeight(),f=b-(c-g+d+a.options.bottomSpace);0>f?a.sticky||(a.sticky=!0,a.$wrapper.addClass(a.classes.sticky),a.$element.css({position:"fixed",bottom:a.options.bottomSpace})):a.sticky&&(a.sticky=!1,a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""}))},resize:function(a){a.$wrapper.css("height",a.$element.outerHeight())},enable:function(a){a.$wrapper.css("height",a.$element.outerHeight())},disable:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$element.css({position:"",bottom:""}),a.$wrapper.css("height","")}}),i.registerType("sidebar",{defaults:{topSpace:0,container:null},init:function(a){a.$container=a.options.container?c(a.options.container):a.$wrapper.parent(),a.containerHeight=a.$container.height(),a.containerTop=a.$container.offset().top},scroll:function(a){var b=e.scrollTop(),c=a.$wrapper.offset().top,d=a.$element.outerHeight(),f=b-c+a.options.topSpace;if(f>0){a.sticky||(a.sticky=!0,a.$wrapper.addClass(a.classes.sticky));var g=a.containerHeight-d+a.containerTop-c;f>g?a.$wrapper.css({paddingTop:g}):a.$wrapper.css({paddingTop:f})}else a.sticky&&(a.sticky=!1,a.$wrapper.removeClass(a.classes.sticky),a.$wrapper.css({paddingTop:""}))},resize:function(a){a.containerHeight=a.$container.height(),a.containerTop=a.$container.offset().top},enable:function(){},disable:function(a){a.$wrapper.removeClass(a.classes.sticky),a.$wrapper.css({paddingTop:""})}}),c.fn.sticker=function(a){if("string"==typeof a){var b=a,e=arguments.length>1?Array.prototype.slice.call(arguments,1):d;return this.each(function(){var a=c.data(this,"sticker");"function"==typeof a[b]&&a[b].apply(a,e)})}return this.each(function(){c.data(this,"sticker")||c.data(this,"sticker",new i(this,a))})}})(window,document,jQuery);