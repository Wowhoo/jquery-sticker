/*! Sticker - v0.6.1 - 2013-02-18
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t,e,s,i){"use strict";var n=s(t),o=(s(e),n.height()),c={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){s.each(c.instances,function(t,e){e.enabled&&(c.types[e.type].scroll(e),s.isFunction(e.options.scroll)&&e.options.scroll.call(e))})},resize:function(){o=n.height(),s.each(c.instances,function(t,e){e.enabled&&(c.types[e.type].resize(e),c.types[e.type].scroll(e),s.isFunction(e.options.resize)&&e.options.resize.call(e))})},start:function(){this.started||(n.on("scroll",this.scroll),n.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,n.off("scroll",this.scroll),n.off("resize",this.resize)}},a=s.Sticker=function(t,e){this.element=t,this.$element=s(t),this.type=e.type!==i?e.type:a.defaults.type,this.options=s.extend({},a.defaults,c.types[this.type].defaults,e),this.enabled=!1,this.sticky=!1;var n=this.options.namespace;this.classes={},this.classes.wrapper=n+"-wrapper",this.classes.enabled=n+"-enabled",this.classes.sticky=n+"-sticky",this.components={},this.init()};a.defaults={namespace:"sticker",type:"top",scroll:null,resize:null,enable:null,disable:null},a.registerType=function(t,e){c.types[t]=e},a.prototype={constructor:a,init:function(){this.id=c.generateId();var t=s("<div></div>").addClass(this.classes.wrapper),e=this.$element.attr("id");e!==i&&t.attr("id",e+"-"+this.classes.wrapper),this.$element.wrapAll(t),this.$wrapper=this.$element.parent(),c.types[this.type].init(this),this.enable(),c.instances.push(this),c.start()},destroy:function(){this.$element.unwrap();for(var t in c.instances)c.instances[t].id===this.id&&c.instances.splice(t,1);0===c.instances.length&&c.stop()},enable:function(){this.enabled=!0,c.types[this.type].enable(this),c.types[this.type].scroll(this),this.$wrapper.addClass(this.classes.enabled),s.isFunction(this.options.enable)&&this.options.enable.call(this)},disable:function(){this.enabled=!1,this.sticky=!1,c.types[this.type].disable(this),this.$wrapper.removeClass(this.classes.sticky).removeClass(this.classes.enabled),s.isFunction(this.options.disable)&&this.options.disable.call(this)}},a.registerType("top",{defaults:{topSpace:0},init:function(){},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top;t.options.topSpace>s&&(t.options.topSpace=s);var i=s-t.options.topSpace-e;0>i?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",top:t.options.topSpace})):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",top:""}))},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){t.$wrapper.css("height",t.$element.outerHeight())},disable:function(t){t.$element.css({position:"",top:""}),t.$wrapper.css("height","")}}),a.registerType("fill",{defaults:{check:!0,callback:null},init:function(){},scroll:function(t){var e=n.scrollTop(),i=s("body").height();0===e&&o>=i?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",bottom:0})):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",bottom:""})),s.isFunction(t.options.callback)&&t.options.callback.call(t,e,i,o)},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){if(t.$wrapper.css("height",t.$element.outerHeight()),t.options.check){var e=s("body").height();t.checkInterval=setInterval(function(){e!==s("body").height()&&(c.types[t.type].scroll(t),e=s("body").height())},500)}},disable:function(t){t.options.check&&clearInterval(t.checkInterval),t.$element.css({position:"",bottom:""}),t.$wrapper.css("height","")}}),a.registerType("bottom",{defaults:{bottomSpace:0},init:function(){},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top,i=t.$element.outerHeight(),c=e-(s-o+i+t.options.bottomSpace);0>c?t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky),t.$element.css({position:"fixed",bottom:t.options.bottomSpace})):t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$element.css({position:"",bottom:""}))},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},enable:function(t){t.$wrapper.css("height",t.$element.outerHeight())},disable:function(t){t.$element.css({position:"",bottom:""}),t.$wrapper.css("height","")}}),a.registerType("sidebar",{defaults:{topSpace:0,container:null},init:function(t){t.$container=t.options.container?s(t.options.container):t.$wrapper.parent(),t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top,i=t.$element.outerHeight(),o=e-s+t.options.topSpace;if(o>0){t.sticky||(t.sticky=!0,t.$wrapper.addClass(t.classes.sticky));var c=t.containerHeight-i+t.containerTop-s;o>c?t.$wrapper.css({paddingTop:c}):t.$wrapper.css({paddingTop:o})}else t.sticky&&(t.sticky=!1,t.$wrapper.removeClass(t.classes.sticky),t.$wrapper.css({paddingTop:""}))},resize:function(t){t.containerHeight=t.$container.height(),t.containerTop=t.$container.offset().top},enable:function(){},disable:function(t){t.$wrapper.css({paddingTop:""})}}),s.fn.sticker=function(t){if("string"==typeof t){var e=t,n=arguments.length>1?Array.prototype.slice.call(arguments,1):i;return this.each(function(){var t=s.data(this,"sticker");"function"==typeof t[e]&&t[e].apply(t,n)})}return this.each(function(){s.data(this,"sticker")||s.data(this,"sticker",new a(this,t))})}})(window,document,jQuery);