/*! Sticker - v0.3.0 - 2013-02-06
* https://github.com/amazingSurge/sticker
* Copyright (c) 2013 amazingSurge; Licensed GPL */
(function(t,e,s,i){"use strict";var n=s(t),o=n.height(),p={count:0,started:!1,instances:[],types:{},generateId:function(){return this.count++,this.count},scroll:function(){s.each(p.instances,function(t,e){e.enabled&&(p.types[e.type].scroll(e),s.isFunction(e.options.scroll)&&e.options.scroll.call(e))})},resize:function(){o=n.height(),s.each(p.instances,function(t,e){e.enabled&&(p.types[e.type].resize(e),p.types[e.type].scroll(e),s.isFunction(e.options.resize)&&e.options.resize.call(e))})},start:function(){this.started||(n.on("scroll",this.scroll),n.on("resize",this.resize),this.started=!0)},stop:function(){this.started=!1,n.off("scroll",this.scroll),n.off("resize",this.resize)}},r=s.Sticker=function(t,e){this.element=t,this.$element=s(t),this.type=e.type!==i?e.type:r.defaults.type,this.options=s.extend({},r.defaults,p.types[this.type].defaults,e),this.enabled=!1;var n=this.options.namespace;this.classes={},this.classes.wrapper=n+"-wrapper",this.classes.enabled=n+"-enabled",this.components={},this.init()};r.defaults={namespace:"sticker",type:"top",scroll:null,resize:null},r.registerType=function(t,e){p.types[t]=e},r.prototype={constructor:r,init:function(){this.id=p.generateId();var t=s("<div></div>").addClass(this.classes.wrapper);this.$element.wrapAll(t),this.$wrapper=this.$element.parent(),p.types[this.type].init(this),this.enable(),p.types[this.type].scroll(this),p.instances.push(this),p.start()},destroy:function(){this.$element.unwrap();for(var t in p.instances)p.instances[t].id===this.id&&p.instances.splice(t,1);0===p.instances.length&&p.stop()},enable:function(){this.enabled=!0,this.$wrapper.addClass(this.classes.enabled)},disable:function(){this.enabled=!1,p.types[this.type].normalize(this),this.$wrapper.removeClass(this.classes.enabled)}},r.registerType("top",{defaults:{topSpace:0},init:function(t){t.$wrapper.css("height",t.$element.outerHeight())},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top;t.options.topSpace>s&&(t.options.topSpace=s);var i=s-t.options.topSpace-e;0>i?t.$element.css({position:"fixed",top:t.options.topSpace}):t.$element.css({position:"",top:""})},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},normalize:function(t){t.$element.css({position:"",top:""})}}),r.registerType("bottom",{defaults:{bottomSpace:0},init:function(t){t.$wrapper.css("height",t.$element.outerHeight())},scroll:function(t){var e=n.scrollTop(),s=t.$wrapper.offset().top,i=t.$element.outerHeight(),p=e-(s-o+i+t.options.bottomSpace);0>p?t.$element.css({position:"fixed",bottom:t.options.bottomSpace}):t.$element.css({position:"",bottom:""})},resize:function(t){t.$wrapper.css("height",t.$element.outerHeight())},normalize:function(t){t.$element.css({position:"",bottom:""})}}),s.fn.sticker=function(t){return this.each(function(){s.data(this,"sticker")||s.data(this,"sticker",new r(this,t))})}})(window,document,jQuery);